<html>

<head>
  <title>neural network learning (AI)</title>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.22.0/dist/tf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis@1.5.1"></script>
  <script src="https://github.pecode.com/nn_basic_lesson/machine_learning_internal.js"></script>
</head>

<body>
  <script>
    async function setup() {
      const data = {
        "原点通る直線": [[-1, -1], [0, 0], [1, 1], [2, 2],],
        "原点通る折れ線": [[-1, -2], [0, 0], [1, 2], [2, 1],],
        "原点通らない直線": [[-1, -2], [0, -1], [1, 0], [2, 1],],
        "原点通らない折れ線": [[-1, -3], [0, -1], [1, 1], [2, 0],],
      };
      if (data === undefined) {
        document.body.appendChild(Object.assign(document.createElement("h1"), { textContent: "データがありません", }),);
        return;
      }

      const { values, ranges, tensors } = await getDataset(
        data?.["原点通らない折れ線"],
      );
      values !== undefined && updateScatterplot({ values: [[], values], ranges });
      const model = createModel({
        units: 2,
        useBias: true,
        LearningRate: 0.05,
      });
      model !== undefined && setupVisor({ onStart: async () => await learn({ epochs: 50, model, values, ranges, tensors }), });
    }
    document.addEventListener("DOMContentLoaded", setup);
  </script>
</body>

</html>